### Add Hocuspocus-style Auth (optional)

#### Scope

- Implement MessageType.Auth handshake (Token → Authenticated/PermissionDenied) in `packages/server/src/lib.rs`.
- Provide pluggable `AuthProvider` trait plus built-in static token provider.
- Gate message handling until authenticated (queue/ignore non-auth until token received), mirroring upstream.
- Update `.cursorrules` and docs first. No changes to `learn-projects/*`.

#### Key behaviors to mirror

- Incoming first frame per document must be Auth when auth is enabled:
  - Frame: `[varstring documentName][varuint 2][varuint 0][varstring token]`
- Success reply: `[varstring documentName][varuint 2][varuint 2][varstring "readonly"|"read-write"]`
- Deny reply: `[varstring documentName][varuint 2][varuint 1][varstring reason]`
- If non-Auth arrives first, send token request and do not process other frames until auth.

#### Files to edit

- `/.cursorrules`: relax MVP constraint to allow optional Auth (document Hocuspocus handshake; default disabled unless configured).
- `/docs/README.md`: add Auth feature overview and usage.
- `/docs/architecture.md`: note Auth handshake order and gating before state load.
- `/docs/mvp-scope.md`: mark Auth as optional extension (non-blocking to MVP).
- `/docs/plans/202510290242-auth.plan.md`: replace placeholder with this plan summary.
- `/packages/server/src/lib.rs`: add trait + handshake, update inbound flow.

#### Where to change in lib.rs

- Replace current "ignore auth" branch and insert handshake:
```184:208:/home/noah/Desktop/hocuspocus-rs/packages/server/src/lib.rs
                    2 => {
                        // Auth
                        // Ignore auth for MVP (no auth)
                        tracing::debug!("ignoring auth message");
                    }
```

- Add per-connection flags and gating in `on_ws` loop before forwarding frames.
- Add helpers to write Auth replies using existing yrs varint/varstring writers.

#### Public API additions (Rust)

- `enum AuthScope { ReadOnly, ReadWrite }`
- `trait AuthProvider { async fn on_authenticate(&self, document_name: &str, token: &str) -> anyhow::Result<AuthScope>; }`
- `struct StaticTokenAuth { token: String, scope: AuthScope }` implementing `AuthProvider`.
- `AppState` gains optional `auth: Option<Arc<dyn AuthProvider + Send + Sync>>`.

#### Behavior in `on_ws`

- If `auth` configured:
  - Before `load_and_send_state`, require an Auth Token frame for the selected document.
  - If first frame is not Auth→Token: send TokenSyncRequest and ignore until proper token arrives.
  - On success: send Authenticated reply, set `is_authenticated` and `is_readonly`, then proceed to load state and normal flow.
  - On failure: send PermissionDenied and close connection.
- If `auth` not configured: current behavior unchanged; Auth messages are ignored gracefully.

#### Minimal example (docs only)

- Show enabling `StaticTokenAuth` in server setup and expected provider token flow.